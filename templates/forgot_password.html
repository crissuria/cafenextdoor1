{% extends "base.html" %}

{% block title %}Forgot Password - Cafe Next Door{% endblock %}

{% block content %}
<div class="auth-page">
    <div class="auth-container">
        <div class="auth-header">
            <h1>Forgot Password</h1>
            <p>Enter your email address and we'll send you instructions to reset your password.</p>
        </div>
        
        <form method="POST" class="auth-form">
            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" name="email" required placeholder="Enter your email">
            </div>
            
            <button type="submit" class="btn btn-primary btn-full">Send Reset Link</button>
        </form>
        
        <div class="auth-footer">
            <a href="{{ url_for('customer_login') }}">‚Üê Back to Login</a>
        </div>
    </div>
</div>

{% if reset_link %}
<script>
window.addEventListener('load', function() {
    const link = '{{ reset_link }}';
    const email = '{{ reset_email }}';
    
    // Show alert with reset link
    const message = 'üìß Password Reset Link\n\n' +
                   'A password reset link has been generated for:\n' + email + '\n\n' +
                   'Reset Link:\n' + link + '\n\n' +
                   '(Simulated - for testing purposes)\n\n' +
                   'The link has been copied to your clipboard!\n\n' +
                   'Click OK, then paste the link in your browser to reset your password.';
    
    alert(message);
    
    // Copy to clipboard
    if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(link).then(function() {
            console.log('Reset link copied to clipboard');
        }).catch(function(err) {
            console.error('Failed to copy link:', err);
        });
    } else {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = link;
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        try {
            document.execCommand('copy');
            console.log('Reset link copied to clipboard (fallback)');
        } catch (err) {
            console.error('Failed to copy link:', err);
        }
        document.body.removeChild(textArea);
    }
});
</script>
{% endif %}
{% endblock %}

